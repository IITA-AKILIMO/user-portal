(()=>{"use strict";function e(e){return"application/vnd.google-apps.folder"===e}var t,n,d=igd.ModuleBuilderModal;t=jQuery,n={init:function(){t("#edd_download_files .edd-add-repeatable-row").append('<div class="igd-edd"><button type="button" class="button button-secondary igd-edd-button"><img src="'.concat(igd.pluginUrl,'/assets/images/drive.png" width="20"/><span>').concat(wp.i18n.__("Add File","integrate-google-drive"),"</span></button></div>")),t(document).on("click",".igd-edd-button",(function(e){e.preventDefault(),Swal.fire({html:'<div id="igd-select-files" class="igd-module-builder-modal-wrap"></div>',showConfirmButton:!1,customClass:{container:"igd-module-builder-modal-container"},didOpen:function(e){var t=document.getElementById("igd-select-files");ReactDOM.render(React.createElement(d,{initData:{},onUpdate:function(e){n.insertFiles(e),Swal.close()},onClose:function(){return Swal.close()},isSelectFiles:!0}),t)},willClose:function(e){var t=document.getElementById("igd-select-files");ReactDOM.unmountComponentAtNode(t)}})}))},insertFiles:function(n){var d=n.folders;(void 0===d?[]:d).map((function(n){var d=n.id,i=n.name,a=n.type,o=n.accountId,c="\n                https://drive.google.com/open?action=igd-edd-download&id=".concat(d,"&account_id=").concat(o);e(a)&&(c+="&is_folder=1");var l=t(".igd-edd").parents(".edd_repeatable_table").find(".edd_repeatable_row:last"),s=function(e){var n,d,i=n=1;return e.parent().find(".edd_repeatable_row").each((function(){var e=t(this).data("key");parseInt(e)>n&&(n=e)})),i=n+=1,(d=e.clone()).removeClass("edd_add_blank"),d.attr("data-key",i),d.find("input, select, textarea").val("").each((function(){var e=t(this).attr("name"),n=t(this).attr("id");e&&(e=e.replace(/\[(\d+)\]/,"["+parseInt(i)+"]"),t(this).attr("name",e)),t(this).attr("data-key",i),void 0!==n&&(n=n.replace(/(\d+)/,parseInt(i)),t(this).attr("id",n))})),d.find("select").each((function(){t(this).val(e.find('select[name="'+t(this).attr("name")+'"]').val())})),d.find('input[type="checkbox"]').each((function(){t(this).is(":checked")&&t(this).prop("checked",!1),t(this).val(1)})),d.find("span.edd_price_id").each((function(){t(this).text(parseInt(i))})),d.find("span.edd_file_id").each((function(){t(this).text(parseInt(i))})),d.find(".edd_repeatable_default_input").each((function(){t(this).val(parseInt(i)).removeAttr("checked")})),d.find(".edd_repeatable_index").each((function(){t(this).val(parseInt(i))})),d.find(".edd_repeatable_condition_field").each((function(){t(this).find("option:eq(0)").prop("selected","selected")})),d.find(".search-choice").remove(),d.find(".chosen-container").remove(),d}(l);s.find(".edd_repeatable_name_field").val(i),s.find(".edd_repeatable_upload_field").val(c),s.insertAfter(l).find("input, textarea, select").filter(":visible").eq(0).focus(),s.find(".edd-select-chosen").chosen({inherit_select_classes:!0,placeholder_text_single:edd_vars.one_option,placeholder_text_multiple:edd_vars.one_or_more_option}),s.find(".edd-select-chosen").css("width","100%"),s.find(".edd-select-chosen .chosen-search input").attr("placeholder",edd_vars.search_placeholder)}))}},t(document).ready(n.init)})();